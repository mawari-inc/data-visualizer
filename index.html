<!DOCTYPE html>
<html>
<head>
	<title>Mawari Data Visualizer</title>
</head>
<body>
	<h1>Mawari Data Visualizer</h1>
	<h2>Impressions Timeline</h2>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
	<div style="width: 1200px">
		<canvas id="chart1"></canvas>
	</div>
	<h2>Creatives</h2>
	<table>
		<tr>
			<td style="vertical-align: top;">
				<div style="width: 600px;">
					{{table}}
				</div>
			</td>
			<td style="vertical-align: top;">
				<div style="height: 600px; width: 600px;">
					<canvas id="chart2"></canvas>
				</div>
			</td>
		</tr>
	</table>
	<script>
		var ctx1 = document.getElementById("chart1").getContext("2d");
		var chart = new Chart(ctx1, {
	    	// The type of chart we want to create
	    	type: "line",

	    	// The data for our dataset
	    	data: "{{chartData}}",

    		// Configuration options go here
    		options: {}
    	});

		var doughnutData = {
			labels: ["Impressions", "Interactions", "Clicks"],
			datasets: [{
				label: "Event Count",
				backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f"],
				data: []
			}]
		};

		const creativeDataURL = "http://localhost:3000/000";
		const params = {
			method: "GET"
		};

		fetch(creativeDataURL, params).then(data => {
			return data.json();
		}).then(res => {
			doughnutData.datasets[0].data = [res.impressionCount, res.interactionCount, res.clickCount];

			var ctx2 = document.getElementById("chart2").getContext("2d");
			var doughnut = new Chart(ctx2, {
				// The type of chart we want to create
				type: "doughnut",

		    	// The data for our dataset
		    	data: doughnutData,

	    		// Configuration options go here
	    		options: {}
	    	});
		}).catch(error => {
			console.log(error);
		});
	</script>
</body>
</html>
